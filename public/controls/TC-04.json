{
  "ControlID": "TC-04",
  "OriginalTopic": "",
  "Category": "4.3.1 การเชื่อมโยงข้อมูล (API Integration)",
  "Metadata": {
    "ApplicationType": "ALL",
    "ServiceType": "Partial, Fully",
    "Compliance": "Mandatory",
    "ImpactLevels": {
      "Low": "-",
      "Medium": "-",
      "High": "-"
    }
  },
  "OriginalRecommendations": "บันทึกข้อมูลการเรียกใช้งาน API ทั้งคำขอและคำตอบ เพื่อใช้ตรวจสอบย้อนหลัง",
  "AI_Processed": {
    "Topic": "การบันทึกข้อมูลการทำธุรกรรมผ่าน API",
    "Recommendations": [
      "ควรจัดให้มีการบันทึกข้อมูล (Log) การเรียกใช้งาน API ทั้งในส่วนของคำขอ (Request) และคำตอบ (Response) เพื่อประโยชน์ในการตรวจสอบย้อนหลังเมื่อเกิดปัญหา, การสืบสวนเหตุการณ์ด้านความปลอดภัย (Incident Investigation) และเป็นหลักฐานยืนยันการทำธุรกรรม (Non-repudiation)",
      "ข้อมูลสำคัญที่ควรบันทึกได้แก่ วันเวลาที่เกิดรายการ (Timestamp), ที่อยู่ไอพีต้นทาง (Source IP), ข้อมูลระบุตัวตนผู้ใช้ (User Identifier), API Endpoint ที่ถูกเรียก, สถานะการตอบกลับ (HTTP Status Code), และส่วนของข้อมูลที่ส่งหรือรับ (Request/Response Body)",
      "สิ่งสำคัญอย่างยิ่งคือการป้องกันข้อมูลที่ละเอียดอ่อน (Sensitive Data) รั่วไหลผ่าน Log โดยต้องมีกระบวนการปกปิด (Masking) หรือลบข้อมูลสำคัญออกก่อนการจัดเก็บ เช่น รหัสผ่าน, API Keys, Access Tokens และข้อมูลส่วนบุคคล (PII) เพื่อให้สอดคล้องกับหลักการรักษาความปลอดภัยและกฎหมายคุ้มครองข้อมูลส่วนบุคคล"
    ],
    "Checklist": [
      "มีการบันทึก Log การเรียกใช้งาน API ครอบคลุมทั้งฝั่งคำขอ (Request) และฝั่งคำตอบ (Response) หรือไม่?",
      "Log ที่บันทึกมีข้อมูลสำคัญครบถ้วนหรือไม่? (เช่น Timestamp, Source IP, User ID, Endpoint, Status Code)",
      "มีการปกปิดหรือลบข้อมูลที่ละเอียดอ่อน เช่น รหัสผ่าน, Access Token, หรือข้อมูลส่วนบุคคล (PII) ออกจาก Log ก่อนจัดเก็บหรือไม่?",
      "มีการจัดเก็บ Log ไว้ในที่ปลอดภัยและมีการควบคุมการเข้าถึงที่เหมาะสมตามนโยบายหรือไม่?"
    ],
    "Evidence": [
      "เอกสารนโยบายการจัดการและจัดเก็บ Log (Log Management and Retention Policy) ที่ระบุระยะเวลาการจัดเก็บและมาตรการรักษาความปลอดภัย",
      "ตัวอย่าง Log การเรียกใช้ API ที่แสดงให้เห็นข้อมูลที่บันทึกครบถ้วน และแสดงให้เห็นว่ามีการปกปิดข้อมูลที่ละเอียดอ่อนอย่างถูกต้อง",
      "ภาพหน้าจอการตั้งค่า (Configuration) ของระบบบันทึก Log หรือส่วนของ Code ที่เกี่ยวข้องกับการบันทึก Log"
    ],
    "SuggestedCorrections": [
      "Control นี้เป็นพื้นฐานสำคัญด้านความปลอดภัย ควรบังคับใช้ (Mandatory) กับทุกระดับผลกระทบ (Low, Mid, High Impact) เนื่องจากจำเป็นอย่างยิ่งต่อการตรวจสอบและสืบสวนเหตุการณ์",
      "ควรระบุในข้อแนะนำให้ชัดเจนว่าการจัดเก็บ Log ต้องเป็นไปตาม พ.ร.บ. ว่าด้วยการกระทำความผิดเกี่ยวกับคอมพิวเตอร์ฯ และกฎหมายคุ้มครองข้อมูลส่วนบุคคล (PDPA)"
    ],
    "IsUnclear": false,
    "UnclearReason": ""
  },
  "ProcessingError": false
}